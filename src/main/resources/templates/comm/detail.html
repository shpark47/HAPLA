<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HAPLA ì»¤ë®¤ë‹ˆí‹°</title>
    <link href="/css/detail.css" rel="stylesheet" type="text/css">
    <script src="https://code.jquery.com/jquery-3.7.1.js" integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4=" crossorigin="anonymous"></script>
</head>
<body>
<div th:replace="~{common/header.html :: topbar}"></div>
<main>
    <section class="banner">
        <img src="/img/communityBanner.png" alt="ì»¤ë®¤ë‹ˆí‹° ë°°ë„ˆ">
        <div class="overlay">
            <h1>ì—¬í–‰ì˜ ì„¤ë ˜ì„ í•¨ê»˜ ë‚˜ëˆ„ëŠ” ê³µê°„ì—ì„œ ë‹¹ì‹ ì˜ ì •ë³´ë¥¼ ê³µìœ í•´ë³´ì„¸ìš”</h1>
        </div>
    </section>
    <section class="community">
        <form class="needs-validation" method="POST" id="detailForm">
        	<!-- ë¡œê·¸ì¸í•œ ì‚¬ìš©ìì˜ userNoë¥¼ hidden inputìœ¼ë¡œ ì¶”ê°€ -->
			<input type="hidden" id="userNo" th:value="${session.loginUser != null ? session.loginUser.userNo : ''}">
            <input type="hidden" name="commNo" th:value="${c.commNo}">
            <input type="hidden" name="page" th:value="${page}">
            <h2 style="display: inline-block;">ì»¤ë®¤ë‹ˆí‹°</h2>
			<button id="likeBtn" class="btn btn-outline-danger btn-sm" style="margin-left: 10px;">
			    â¤ï¸ <span id="likeCount" th:text="${c != null ? c.likes : 0}"></span>
			</button>
			<button class="cancel-button" type="button" onclick="history.back();">ëª©ë¡</button>
            <table>
                <tr>
                    <th>ì œëª©</th>
                    <td colspan="3" width="400px" th:text="${c != null ? c.title : 'ì œëª© ì—†ìŒ'}"></td>
                </tr>
                <tr>
                    <th width="50px">ë“±ë¡ì</th>
                    <td th:text="${c != null ? c.name : 'ë“±ë¡ì ì—†ìŒ'}"></td>
                </tr>
                <tr>
                    <th width="50px">ë“±ë¡ì¼</th>
                    <td th:text="${c != null and c.createDate != null ? #dates.format(c.createDate, 'yyyy-MM-dd') : 'ë‚ ì§œ ì—†ìŒ'}"></td>
                </tr>
                <tr>
                    <th>ì¡°íšŒìˆ˜</th>
                    <td th:text="${c != null ? c.views : 0}"></td>
                </tr>
                <tr>
                    <td colspan="9">[[${c.commContent}]]</td> <!-- âœ… ìˆ˜ì • -->
                </tr>
            </table>

            <th:block th:if="${session.loginUser != null && session.loginUser.userNo == c.userNo}">
                <button class="w-100 btn btn-success btn-lg" type="button" id="updateForm">ìˆ˜ì •</button>
                <button class="w-100 btn btn-secondary btn-lg" type="button" id="deleteModal">ì‚­ì œ</button>
            </th:block>

            <div class="input-group">
                <textarea class="form-control" rows="1" id="replyContent" style="resize:none;"></textarea>
                <button class="btn btn-outline-success btn-lg" id="replySubmit" th:disabled="${session.loginUser == null}">SUBMIT
                </button>
            </div>
            <br>
			<table class="table">
                <thead>
                <tr>
                    <th width="130px">ì‘ì„±ì</th>
                    <th>ì‘ì„±ë‚´ìš©</th>
                    <th width="90px">ì‘ì„±ì¼ì</th>
                    <th></th>
                    <th></th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="r: ${list}">
                    <td>[[${r.name}]]</td>
                    <td>
					    <span th:text="${r.replyContent}"></span>
<!-- 					    <th:block th:if="${session.loginUser != null && r.name != session.loginUser.name}"> -->
<!-- 					        <input type="hidden" th:value="${r.replyNo}" name="replyNo"> -->
<!-- 					        <button type="button" class="btn btn-sm btn-outline-primary reply-btn" id="rereply">ë‹µê¸€ì“°ê¸°</button> -->
<!-- 					    </th:block> -->
					</td>
                    <td>[[${r.createDate}]]</td>
                    <td width="50px">
                        <th:block th:if="${session.loginUser ne null && r.name ne session.loginUser.name}">
                            <input type="hidden" th:value="${r.replyNo}" name="replyNo">
                            <button class="w-100 btn btn-success btn-lg" type="button" id="ask">ì‹ ê³ </button>
                        </th:block>
                    </td>
                    <td width="50px">
                        <th:block th:if="${session.loginUser != null && r.name eq session.loginUser.name}">
                            <input type="hidden" th:value="${r.replyNo}" name="replyNo">
                            <span class="updel"> <!-- ìˆ˜ì • ì•„ì´ì½˜ (ì—°í•„ ëª¨ì–‘) -->
                						<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                                             fill="currentColor" class="bi bi-pencil" viewBox="0 0 16 16"><path
                                                d="M12.146.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1 0 .708l-10 10a.5.5 0 0 1-.168.11l-5 2a.5.5 0 0 1-.65-.65l2-5a.5.5 0 0 1 .11-.168l10-10zM11.207 2.5 13.5 4.793 14.793 3.5 12.5 1.207zm1.586 3L10.5 3.207 4 9.707V10h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.293zm-9.761 5.175-.106.106-1.528 3.821 3.821-1.528.106-.106A.5.5 0 0 1 5 12.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.468-.325z"/></svg>
                					</span>
                            &nbsp;
                            <span class="updel"> <!-- ì‚­ì œ ì•„ì´ì½˜ (ì“°ë ˆê¸°í†µ ëª¨ì–‘) -->
                						<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                                             fill="currentColor" class="bi bi-trash3" viewBox="0 0 16 16"><path
                                                d="M6.5 1h3a.5.5 0 0 1 .5.5v1H6v-1a.5.5 0 0 1 .5-.5M11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3A1.5 1.5 0 0 0 5 1.5v1H2.506a.58.58 0 0 0-.01 0H1.5a.5.5 0 0 0 0 1h.538l.853 10.66A2 2 0 0 0 4.885 16h6.23a2 2 0 0 0 1.994-1.84l.853-10.66h.538a.5.5 0 0 0 0-1h-.995a.59.59 0 0 0-.01 0zm1.958 1-.846 10.58a1 1 0 0 1-.997.92h-6.23a1 1 0 0 1-.997-.92L3.042 3.5zm-7.487 1a.5.5 0 0 1 .528.47l.5 8.5a.5.5 0 0 1-.998.06L5 5.03a.5.5 0 0 1 .47-.53Zm5.058 0a.5.5 0 0 1 .47.53l-.5 8.5a.5.5 0 1 1-.998-.06l.5-8.5a.5.5 0 0 1 .528-.47ZM8 4.5a.5.5 0 0 1 .5.5v8.5a.5.5 0 0 1-1 0V5a.5.5 0 0 1 .5-.5"/></svg>
                					</span>
                            <input type="hidden" th:value="${r.replyContent}"> <!-- ëŒ“ê¸€ ìˆ˜ì •ì€ ì•ˆ í•˜ê³  ì›ë˜ ëŒ“ê¸€ë¡œ ëŒë ¤ë†“ìœ¼ë ¤ê³  í•  ë•Œ ì‚¬ìš© -->
                        </th:block>
                    </td>
                </tr>
                </tbody>
            </table>

		</form>
    </section>
</main>
<div th:replace="~{common/footer.html :: foot}"></div>
<div class="modal fade" tabindex="-1" role="dialog" id="modalChoice">
    <div class="modal-dialog modal-dialog-centered" role="document"> <!-- âœ… ì¤‘ì•™ ì •ë ¬ í´ë˜ìŠ¤ ì¶”ê°€ -->
        <div class="modal-content rounded-3 shadow">
            <div class="modal-body p-4 text-center">
                <h3 class="mb-0">ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?</h3>
                <p class="mb-0">ì‚­ì œ í›„ ê²Œì‹œê¸€ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>
            </div>
            <div class="modal-footer flex-nowrap p-0">
                <button type="button"
                        class="btn btn-lg btn-link fs-6 text-decoration-none col-6 m-0 rounded-0 border-end"
                        id="delete">
                    <strong>ë„¤</strong>
                </button>
                <button type="button" class="btn btn-lg btn-link fs-6 text-decoration-none col-6 m-0 rounded-0"
                        data-bs-dismiss="modal">ì•„ë‹ˆì˜¤
                </button>
            </div>
        </div>
    </div>
</div>

<script th:inline="javascript">
	window.addEventListener('load', () => {
        const form = document.getElementById('detailForm');
        const updateButton = document.getElementById('updateForm'); // ìˆ˜ì • ë²„íŠ¼
        const deleteButton = document.getElementById('deleteModal'); // ì‚­ì œ ë²„íŠ¼
        const deleteConfirm = document.getElementById('delete'); // ì‚­ì œ í™•ì¸ ë²„íŠ¼
        const deleteModal = document.getElementById('modalChoice'); // ì‚­ì œ ëª¨ë‹¬
        const closeModalButtons = document.querySelectorAll("[data-bs-dismiss='modal']"); // ì·¨ì†Œ ë²„íŠ¼ë“¤

        // ğŸ”¹ ê²Œì‹œê¸€ ìˆ˜ì • ë²„íŠ¼ í´ë¦­ ì‹œ
        if (updateButton) {
            updateButton.addEventListener('click', () => {
                form.action = '/comm/updForm';
                form.submit();
            });
        }

        // ğŸ”¹ ì‚­ì œ ë²„íŠ¼ í´ë¦­ ì‹œ ëª¨ë‹¬ í‘œì‹œ
        if (deleteButton) {
            deleteButton.addEventListener('click', () => {
                deleteModal.style.display = "flex"; // ëª¨ë‹¬ ë³´ì´ê¸°
            });
        }

        // ğŸ”¹ ëª¨ë‹¬ ë‚´ ì·¨ì†Œ ë²„íŠ¼ í´ë¦­ ì‹œ ë‹«ê¸°
        closeModalButtons.forEach(button => {
            button.addEventListener("click", () => {
                deleteModal.style.display = "none"; // ëª¨ë‹¬ ìˆ¨ê¸°ê¸°
            });
        });

        // ğŸ”¹ ëª¨ë‹¬ ì™¸ë¶€ í´ë¦­ ì‹œ ë‹«ê¸°
        window.addEventListener("click", (event) => {
            if (event.target === deleteModal) {
                deleteModal.style.display = "none";
            }
        });

        // ğŸ”¹ ì‚­ì œ í™•ì¸ ë²„íŠ¼ í´ë¦­ ì‹œ í¼ ì œì¶œ (ê²Œì‹œê¸€ ì‚­ì œ)
        if (deleteConfirm) {
            deleteConfirm.addEventListener("click", () => {
                form.action = '/comm/delete';
                form.submit();
            });
        }
    });
	
	const tbody = document.querySelectorAll('tbody')[1];
	
	/*<![CDATA[*/
	document.getElementById('replySubmit').addEventListener('click', e => {
		e.preventDefault();
		$.ajax({
			url: '/comm/reply',
			type: 'post',
			dataType: 'json',
			data: {
				replyContent:document.getElementById('replyContent').value,
				commNo:/*[[${c.commNo}]]*/1,
				name:/*[[${c.name}]]*/'user01',
				userNo:/*[[${session.loginUser != null ? session.loginUser.userNo : ''}]]*/'user01'
			},
			success: data => {
				console.log(data);
				
				tbody.innerHTML = '';
				for(const r of data){
					const tr = document.createElement('tr');
					
					const writerTd = document.createElement('td');
					const writerVal = document.createTextNode(r.name);
					writerTd.append(writerVal);
					
					const contentTd = document.createElement('td');
					contentTd.innerText = r.replyContent;
					
					tr.append(writerTd);
					tr.append(contentTd);
					tr.innerHTML += '<td>' + r.updateDate + '</td>';
					
					const iconTd = document.createElement('td');  // <td></td>
					iconTd.setAttribute('width', '80px');         // <td width="80px"></td>
					if(r.replyWriter == /*[[${session.loginUser != null ? session.loginUser.userNo : ''}]]*/'user01'){
						iconTd.innerHTML = '<span class="updel"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-pencil" viewBox="0 0 16 16"><path d="M12.146.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1 0 .708l-10 10a.5.5 0 0 1-.168.11l-5 2a.5.5 0 0 1-.65-.65l2-5a.5.5 0 0 1 .11-.168l10-10zM11.207 2.5 13.5 4.793 14.793 3.5 12.5 1.207zm1.586 3L10.5 3.207 4 9.707V10h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.293zm-9.761 5.175-.106.106-1.528 3.821 3.821-1.528.106-.106A.5.5 0 0 1 5 12.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.468-.325z"/></svg></span>&nbsp;&nbsp;<span class="updel"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash3" viewBox="0 0 16 16"><path d="M6.5 1h3a.5.5 0 0 1 .5.5v1H6v-1a.5.5 0 0 1 .5-.5M11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3A1.5 1.5 0 0 0 5 1.5v1H2.506a.58.58 0 0 0-.01 0H1.5a.5.5 0 0 0 0 1h.538l.853 10.66A2 2 0 0 0 4.885 16h6.23a2 2 0 0 0 1.994-1.84l.853-10.66h.538a.5.5 0 0 0 0-1h-.995a.59.59 0 0 0-.01 0zm1.958 1-.846 10.58a1 1 0 0 1-.997.92h-6.23a1 1 0 0 1-.997-.92L3.042 3.5zm-7.487 1a.5.5 0 0 1 .528.47l.5 8.5a.5.5 0 0 1-.998.06L5 5.03a.5.5 0 0 1 .47-.53Zm5.058 0a.5.5 0 0 1 .47.53l-.5 8.5a.5.5 0 1 1-.998-.06l.5-8.5a.5.5 0 0 1 .528-.47ZM8 4.5a.5.5 0 0 1 .5.5v8.5a.5.5 0 0 1-1 0V5a.5.5 0 0 1 .5-.5"/></svg></span><input type="hidden" th:value="' + r.replyContent + '">';
					}
					tr.append(iconTd);
					
					tbody.append(tr);
				}
				document.getElementById('replyContent').value= '';
			},
			error: data => console.log(data)
		});
	});
	/*]]>*/
	
	tbody.addEventListener('click', e => {
				const eventTarget = e.target;
				const targetTagName = eventTarget.tagName.toLowerCase();
				console.log(targetTagName);
				let targetSVG = null;
				switch(targetTagName){
				case 'span': targetSVG = eventTarget.children[0]; break;
				case 'svg': targetSVG = eventTarget;  break;
				case 'path': targetSVG = eventTarget.parentElement;
				}
				
				console.log(targetSVG);
				
				const myTd = targetSVG.parentElement.parentElement;
                const contentTd = myTd.parentElement.children[1];   // ë‚´ìš©ì€ 1ë²ˆì§¸ ì¸ë±ìŠ¤
                const replyId = myTd.children[0].value;
                
                if(targetSVG != null){
                   // console.log(targetSVG.className.baseVal.includes);
                   if(targetSVG.className.baseVal.includes("pencil")){ // í´ë¦­í•œ targetSVGê°€ ì—°í•„ì¼ ë•Œ
                      // ìˆ˜ì •í•  ìˆ˜ ìˆëŠ” view ì „í™˜
                      
//                       console.log(document.getElementsByClassName('bi-check-lg'));
                      const beforeCheckArr = document.getElementsByClassName('bi-check-lg');
					  if(beforeCheckArr.length > 0){
						  // beforeCheckArr[0]   // ì´ì „ì— ìˆì—ˆë˜ ì²´í¬ ë˜ëŠ” ì—‘ìŠ¤ SVG
						  const beforeCheckTd = beforeCheckArr[0].parentElement.parentElement;
						  beforeCheckTd.parentElement.children[1].innerHTML = beforeCheckTd.children[3].value; // content ê°€ ë‹´ê²¨ì ¸ ìˆëŠ” hidden
						  beforeCheckTd.children[1].innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-pencil" viewBox="0 0 16 16"><path d="M12.146.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1 0 .708l-10 10a.5.5 0 0 1-.168.11l-5 2a.5.5 0 0 1-.65-.65l2-5a.5.5 0 0 1 .11-.168l10-10zM11.207 2.5 13.5 4.793 14.793 3.5 12.5 1.207zm1.586 3L10.5 3.207 4 9.707V10h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.293zm-9.761 5.175-.106.106-1.528 3.821 3.821-1.528.106-.106A.5.5 0 0 1 5 12.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.468-.325z"/></svg>';
						  beforeCheckTd.children[2].innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash3" viewBox="0 0 16 16"><path d="M6.5 1h3a.5.5 0 0 1 .5.5v1H6v-1a.5.5 0 0 1 .5-.5M11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3A1.5 1.5 0 0 0 5 1.5v1H2.506a.58.58 0 0 0-.01 0H1.5a.5.5 0 0 0 0 1h.538l.853 10.66A2 2 0 0 0 4.885 16h6.23a2 2 0 0 0 1.994-1.84l.853-10.66h.538a.5.5 0 0 0 0-1h-.995a.59.59 0 0 0-.01 0zm1.958 1-.846 10.58a1 1 0 0 1-.997.92h-6.23a1 1 0 0 1-.997-.92L3.042 3.5zm-7.487 1a.5.5 0 0 1 .528.47l.5 8.5a.5.5 0 0 1-.998.06L5 5.03a.5.5 0 0 1 .47-.53Zm5.058 0a.5.5 0 0 1 .47.53l-.5 8.5a.5.5 0 1 1-.998-.06l.5-8.5a.5.5 0 0 1 .528-.47ZM8 4.5a.5.5 0 0 1 .5.5v8.5a.5.5 0 0 1-1 0V5a.5.5 0 0 1 .5-.5"/></svg>';
					  }
                      
                      contentTd.innerHTML = '<textarea rows="2" cols="30" style="resize:none;">' + contentTd.innerText + '</textarea>';
                      myTd.children[1].innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-check-lg" viewBox="0 0 16 16"><path d="M12.736 3.97a.733.733 0 0 1 1.047 0c.286.289.29.756.01 1.05L7.88 12.01a.733.733 0 0 1-1.065.02L3.217 8.384a.757.757 0 0 1 0-1.06.733.733 0 0 1 1.047 0l3.052 3.093 5.4-6.425a.247.247 0 0 1 .02-.022"/></svg>';
                      myTd.children[2].innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-x-lg" viewBox="0 0 16 16"><path d="M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8z"/></svg>';
                   }else if(targetSVG.className.baseVal.includes("trash")){ // í´ë¦­í•œ targetSVGê°€ ì“°ë ˆê¸°í†µì¼ ë•Œ
                      if(confirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')){
                         $.ajax({
                            url: '/comm/reply',
                            type: 'delete',
                            data: {replyNo : replyNo},
                            success: data => {
                                  console.log(data);
                                  if(data == 1){
                                     myTd.parentElement.remove();
                                  }else{
                                     alert('ëŒ“ê¸€ ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.')
                                  }
                            },
                            error: data => console.log(data)
                         });
                      }
                   } else if(targetSVG.className.baseVal.includes('check')){
                	   // ìˆ˜ì • ì™„ë£Œ
                	   $.ajax({
                           url: '/comm/reply',
                           type: 'put',
                           data: {replyNo : replyNo, replyContent : contentTd.children[0].value},
                		   success: data => {
                			  console.log(data);
                			  if(data == 1){
                					contentTd.innerHTML = contentTd.children[0].value
                    		  		myTd.children[1].innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-pencil" viewBox="0 0 16 16"><path d="M12.146.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1 0 .708l-10 10a.5.5 0 0 1-.168.11l-5 2a.5.5 0 0 1-.65-.65l2-5a.5.5 0 0 1 .11-.168l10-10zM11.207 2.5 13.5 4.793 14.793 3.5 12.5 1.207zm1.586 3L10.5 3.207 4 9.707V10h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.293zm-9.761 5.175-.106.106-1.528 3.821 3.821-1.528.106-.106A.5.5 0 0 1 5 12.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.468-.325z"/></svg>'
                    		  		myTd.children[2].innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash3" viewBox="0 0 16 16"><path d="M6.5 1h3a.5.5 0 0 1 .5.5v1H6v-1a.5.5 0 0 1 .5-.5M11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3A1.5 1.5 0 0 0 5 1.5v1H2.506a.58.58 0 0 0-.01 0H1.5a.5.5 0 0 0 0 1h.538l.853 10.66A2 2 0 0 0 4.885 16h6.23a2 2 0 0 0 1.994-1.84l.853-10.66h.538a.5.5 0 0 0 0-1h-.995a.59.59 0 0 0-.01 0zm1.958 1-.846 10.58a1 1 0 0 1-.997.92h-6.23a1 1 0 0 1-.997-.92L3.042 3.5zm-7.487 1a.5.5 0 0 1 .528.47l.5 8.5a.5.5 0 0 1-.998.06L5 5.03a.5.5 0 0 1 .47-.53Zm5.058 0a.5.5 0 0 1 .47.53l-.5 8.5a.5.5 0 1 1-.998-.06l.5-8.5a.5.5 0 0 1 .528-.47ZM8 4.5a.5.5 0 0 1 .5.5v8.5a.5.5 0 0 1-1 0V5a.5.5 0 0 1 .5-.5"/></svg>'
                			  		myTd.children[3].value = contentTd.innerText;
                			  } else {
                				  alert("ëŒ“ê¸€ ìˆ˜ì • ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
                			  }
                		   },
                		   error: data => console.log(data)
                	   });
                   } else if(targetSVG.className.baseVal.includes('x')){
                	   // ìˆ˜ì • ì·¨ì†Œ : ì—°í•„-ì‚­ì œ viewë¡œ ì „í™˜
                	   contentTd.innerHTML = myTd.children[3].value;
                   	   
                       myTd.children[1].innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-pencil" viewBox="0 0 16 16"><path d="M12.146.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1 0 .708l-10 10a.5.5 0 0 1-.168.11l-5 2a.5.5 0 0 1-.65-.65l2-5a.5.5 0 0 1 .11-.168l10-10zM11.207 2.5 13.5 4.793 14.793 3.5 12.5 1.207zm1.586 3L10.5 3.207 4 9.707V10h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.293zm-9.761 5.175-.106.106-1.528 3.821 3.821-1.528.106-.106A.5.5 0 0 1 5 12.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.468-.325z"/></svg>';
                       myTd.children[2].innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash3" viewBox="0 0 16 16"><path d="M6.5 1h3a.5.5 0 0 1 .5.5v1H6v-1a.5.5 0 0 1 .5-.5M11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3A1.5 1.5 0 0 0 5 1.5v1H2.506a.58.58 0 0 0-.01 0H1.5a.5.5 0 0 0 0 1h.538l.853 10.66A2 2 0 0 0 4.885 16h6.23a2 2 0 0 0 1.994-1.84l.853-10.66h.538a.5.5 0 0 0 0-1h-.995a.59.59 0 0 0-.01 0zm1.958 1-.846 10.58a1 1 0 0 1-.997.92h-6.23a1 1 0 0 1-.997-.92L3.042 3.5zm-7.487 1a.5.5 0 0 1 .528.47l.5 8.5a.5.5 0 0 1-.998.06L5 5.03a.5.5 0 0 1 .47-.53Zm5.058 0a.5.5 0 0 1 .47.53l-.5 8.5a.5.5 0 1 1-.998-.06l.5-8.5a.5.5 0 0 1 .528-.47ZM8 4.5a.5.5 0 0 1 .5.5v8.5a.5.5 0 0 1-1 0V5a.5.5 0 0 1 .5-.5"/></svg>';
                   }
                } 
                   
             });
	
	
	
	
	document.addEventListener("DOMContentLoaded", function() {
	    const likeBtn = document.getElementById("likeBtn");
	    const likeCount = document.getElementById("likeCount");
	    const userNo = document.getElementById("userNo").value;

	    likeBtn.addEventListener("click", function(event) {
	        if (!userNo) { // âœ… ë¡œê·¸ì¸ ì—¬ë¶€ í™•ì¸
	            alert("ì¢‹ì•„ìš”ë¥¼ ëˆ„ë¥´ë ¤ë©´ ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.");
	            return;
	        }

	        $.ajax({
	            url: "/comm/like", 
	            type: "POST",
	            data: { 
	                commNo: /*[[${c.commNo}]]*/ 1, 
	                userNo: /*[[${session.loginUser.userNo}]]*/1
	            },
	            success: function(response) {
	                $("#likeCount").text(response.likes);
	            },
	            error: function(xhr) {
	                console.log("ì—ëŸ¬ ìƒíƒœ ì½”ë“œ:", xhr.status);
	                console.log("ì„œë²„ ì‘ë‹µ:", xhr.responseText);
	                alert("ì¢‹ì•„ìš” ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\n" + xhr.responseText);
	            }
	        });
	        
	        event.preventDefault();
	    });
	});

	
</script>


</body>
</html>