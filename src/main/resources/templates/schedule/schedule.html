<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì—¬í–‰ ì¼ì •</title>
    <link rel="stylesheet" href="/css/schedule.css" type="text/css">
</head>
<body>

    <div class="container">
        <!-- ğŸŒ ì™¼ìª½ ì‚¬ì´ë“œë°” -->
        <div class="sidebar">
            <div class="sidebar-head">
                <span class="menu">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
                        <path d="M 3 5 A 1.0001 1.0001 0 1 0 3 7 L 21 7 A 1.0001 1.0001 0 1 0 21 5 L 3 5 z M 3 11 A 1.0001 1.0001 0 1 0 3 13 L 21 13 A 1.0001 1.0001 0 1 0 21 11 L 3 11 z M 3 17 A 1.0001 1.0001 0 1 0 3 19 L 21 19 A 1.0001 1.0001 0 1 0 21 17 L 3 17 z"></path>
                    </svg>
                </span>
            </div>
            <div class="sidebar-title">
                <span class="trip-title" id="tripTitle"></span>
                <span id="tripDates"></span>
			</div>
            <!-- âœ… ë‚ ì§œë³„ ì¼ì • ë¦¬ìŠ¤íŠ¸ -->
            <div class="date-list" id="dateList"></div>
        </div>

        <!-- ğŸŒ Google ì§€ë„ -->
        <div id="map"></div>
    </div>

    <script>
        // âœ… ì¼ì • í˜ì´ì§€ê°€ ë¡œë“œë  ë•Œ ì‹¤í–‰ë˜ëŠ” í•¨ìˆ˜
        document.addEventListener("DOMContentLoaded", function () {
            const tripData = localStorage.getItem("tripData");

            if (tripData) {
                const data = JSON.parse(tripData);

                // âœ… ì„ íƒí•œ ë„ì‹œ ì •ë³´ ì ìš©
                if (data.city) {
                    document.getElementById("tripTitle").textContent = `${data.city.name}, ${data.city.country}`;
                }

                // âœ… ì„ íƒí•œ ë‚ ì§œ ì •ë³´ ì ìš©
                document.getElementById("tripDates").textContent = `ğŸ“… ${data.startDate} ~ ${data.endDate}`;

                // âœ… ë‚ ì§œë³„ ì¼ì • ë¦¬ìŠ¤íŠ¸ ìƒì„±
                generateDateList(data.startDate, data.endDate);

                // âœ… ì§€ë„ ìœ„ì¹˜ ë³€ê²½
                initMap(data.city.lat, data.city.lng);
            }
        });

        // âœ… ë‚ ì§œë³„ ì¼ì • ë¦¬ìŠ¤íŠ¸ ìƒì„±
        function generateDateList(start, end) {
            const dateList = document.getElementById("dateList");
            dateList.innerHTML = ""; // ê¸°ì¡´ ë‚´ìš© ì´ˆê¸°í™”

            let startDate = new Date(start);
            let endDate = new Date(end);

            while (startDate <= endDate) {
                let formattedDate = startDate.toISOString().split('T')[0];

                let dateContainer = document.createElement("div");
                dateContainer.classList.add("date-container");

                let planDate = document.createElement("div");
                planDate.classList.add("plan-date");
                planDate.textContent = formattedDate; // YYYY-MM-DD í˜•ì‹ìœ¼ë¡œ ì¶œë ¥

                let dateItem = document.createElement("div");
                dateItem.classList.add("date-item");

                let addButton = document.createElement("button");
                addButton.classList.add("control-add");
                addButton.textContent = "â• ì¶”ê°€";

                dateItem.appendChild(addButton);
                dateContainer.appendChild(planDate);
                dateContainer.appendChild(dateItem);
                dateList.appendChild(dateContainer);

                // ë‹¤ìŒ ë‚ ì§œë¡œ ì´ë™
                startDate.setDate(startDate.getDate() + 1);
            }
        }

        // âœ… Google ì§€ë„ ì´ˆê¸°í™” í•¨ìˆ˜
        function initMap(lat = 48.8566, lng = 2.3522) {
            new google.maps.Map(document.getElementById('map'), {
                center: { lat: lat, lng: lng },
                zoom: 10 
            });
        }
    </script>
    
    <!-- Google Maps API -->
    <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAUKMdSgSqvtUy4wZvUxqA6I_c0Zk4InEU&callback=initMap"></script>
    

</body>
</html>
